{% extends 'base.html' %}
{% block content %}
<a href="{{ url_for('dashboard') }}" class="back-link">‚Üê Back to Dashboard</a>
<h1>Attendance History</h1>

{% set current_month = None %}

{% for record in attendance_records|sort(attribute='date') %}
    {% set record_month = record.date.strftime('%B %Y') %}
    
    {% if record_month != current_month %}
        {% if not loop.first %}
            </table>
        {% endif %}
        
        <h2>{{ record_month }}</h2>
        <table class="attendance-table">
            <tr>
                <th>Date</th>
                <th>Worker Name</th>
                <th>Attendance Status</th>
            </tr>
        {% set current_month = record_month %}
    {% endif %}

    <tr>
        <td>{{ record.date.strftime('%d %b %Y') }}</td>
        <td>{{ record.worker.name }}</td>
        <td>{{ record.status }}</td>
    </tr>

    {% if loop.last %}
        </table>
    {% endif %}
{% endfor %}
{% endblock %}
